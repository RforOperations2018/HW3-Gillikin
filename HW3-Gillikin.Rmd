---
title: "HW3-Gillikin"
output: html_document
---

```{r setup, include=FALSE}
require(rgdal)
require(leaflet)
require(leaflet.extras)
require(dplyr)
require(readxl)
require(stringr)
require(sp)
```



```{r}
# Load affordable housing units data for Charlottesville, VA
housing.units <- read.csv("charlottesville_affordable_housing.csv")

# Load US Census tract data for VA
tract <- readOGR("./cb_2017_51_tract_500k/cb_2017_51_tract_500k.shp", layer = "cb_2017_51_tract_500k", GDAL1_integer64_policy = TRUE)

# Load selected Bus 4 data for Charlottesville
bus4 <- readOGR("roads")

# Custom color palatte
palet <- colorFactor(c("#4575b4", "#d73027"), c("multiple", "single"))
```


```{r}
leaflet() %>%
  # Set custom view
  setView(-78.4800, 38.03, 13) %>%
  # Base Groups ---
  addTiles(group = "OSM (default)") %>%
  addProviderTiles("OpenStreetMap.HOT", group = "HOT") %>%
  addProviderTiles("OpenTopoMap", group = "TopoMap") %>%
  # Overlay Groups ---
  # Add clusters of markers for affordable housing units
  addCircleMarkers(data = housing.units, lng = ~long, lat = ~lat, radius = 2, color = ~pal(type), clusterOptions = markerClusterOptions(), group = "Affordable Housing Units") %>%
  # Add legend for circle markers
  addLegend(position = "topright" , pal = palet, values = housing.units$type, title = "Affordable Housing by Type") %>%
  # Add two selected points from Bus 4
  addPolylines(data = bus4, weight = 5, color = "#blue") %>%
  # Add census tracts
  addPolygons(data = tract, fill = F, weight = 3, color = "#444444", group = "Census Tracts") %>%
  # Layers control ---
  addLayersControl(
    baseGroups = c("OSM (default)", "HOT", "TopoMap"),
    overlayGroups = c("Affordable Housing Units", "Census Tracts", "Bus 4 (selected points"),
    options = layersControlOptions(collapsed = FALSE))
```


